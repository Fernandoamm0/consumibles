<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Solicitud de consumibles</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background-color: #1e1e1e; color: #e0e0e0; }
    h1 { text-align: center; margin-bottom: 30px; }
    .contenedor { display: flex; gap: 20px; align-items: flex-start; flex-wrap: wrap; }
    form { flex: 2; background: #2c2c2c; padding: 25px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.5); }
    .manual { flex: 1; background-color: #2c2c2c; border: 1px solid #444; padding: 20px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
    .logo-container { background-color: #fff; padding: 10px; border-radius: 6px; text-align: center; margin-bottom: 15px; }
    .manual img { max-width: 100%; display: block; }
    label { display: block; margin-bottom: 5px; font-weight: bold; }
    input, select { width: 100%; padding: 12px; border-radius: 6px; border: 1px solid #555; background-color: #3a3a3a; color: #e0e0e0; font-size: 14px; box-sizing: border-box; }
    input::placeholder { color: #bbb; }
    button { padding: 12px 25px; font-size: 16px; cursor: pointer; margin-top: 10px; border: none; border-radius: 6px; background-color: #007acc; color: #fff; transition: background-color 0.3s; }
    button:hover { background-color: #005f99; }
    .fila { display: flex; gap: 15px; margin-bottom: 15px; }
    .fila div { flex: 1; display: flex; flex-direction: column; }
    .error { color: #ff6b6b; font-size: 13px; margin-top: 5px; display: none; }
    .success { color: #4caf50; font-size: 14px; margin-top: 10px; display: none; text-align: center; }
    ol li { margin-bottom: 8px; }
  </style>
</head>
<body>
<h1>Solicitud de consumibles</h1>
<div class="contenedor">
  <!-- Formulario -->
  <form id="consumiblesForm">
    <div class="fila">
      <div>
        <label>Ingeniero:</label>
        <select name="ingeniero" id="ingeniero">
          <option value="">Selecciona un ingeniero</option>
          <option value="Alejandro Peralta">Alejandro Peralta</option>
          <option value="Elizabeth Sosa">Elizabeth Sosa</option>
          <option value="Enrique Alegría">Enrique Alegría</option>
          <option value="Francisco Degante">Francisco Degante</option>
          <option value="Guadalupe Garcia">Guadalupe Garcia</option>
          <option value="Israel Rodriguez">Israel Rodriguez</option>
          <option value="Israel Tamayo">Israel Tamayo</option>
        </select>
        <div class="error" id="errorIngeniero">Por favor selecciona un ingeniero.</div>
      </div>
      <div>
        <label>Lote:</label>
        <input type="text" id="lote" name="lote" placeholder="Ej. LOTE123">
        <div class="error" id="errorLote">Por favor ingresa el lote.</div>
      </div>
    </div>
    <div class="fila">
      <div>
        <label>Clave del consumible:</label>
        <input type="text" id="claveConsumible" name="claveConsumible" placeholder="Ej. CONS456">
        <div class="error" id="errorClave">Por favor ingresa la clave del consumible.</div>
      </div>
      <div>
        <label>Cantidad:</label>
        <input type="number" id="cantidad" name="cantidad" min="1" placeholder="1">
        <div class="error" id="errorCantidad">Por favor ingresa la cantidad.</div>
      </div>
    </div>
    <button type="submit">Enviar</button>
    <div class="success" id="mensajeExito">✅ Solicitud enviada correctamente.</div>
  </form>

  <!-- Manual con logo y PDF -->
  <div class="manual">
    <div class="logo-container">
      <img src="https://www.compuservices.com.mx/wpimages/compu-services.png" alt="Logo Compuservices">
    </div>
    <h2>Instrucciones para los técnicos</h2>
    <ol>
      <li>Selecciona tu nombre en el campo <strong>Ingeniero</strong>.</li>
      <li>Ingresa el <strong>Lote</strong> correspondiente.</li>
      <li>Escribe la <strong>Clave del consumible</strong> que necesitas solicitar.</li>
      <li>Indica la <strong>Cantidad</strong> que requieres.</li>
      <li>Presiona <strong>Enviar</strong> para registrar la solicitud.</li>
      <li>Los datos se guardarán automáticamente en Google Sheets.</li>
    </ol>
    <div style="text-align: center; margin-top: 15px;">
      <a href="https://raw.githubusercontent.com/Fernandoamm0/consumibles/main/catalogoconsumibles.pdf" 
         target="_blank"
         style="padding: 10px 20px; background-color: #007acc; color: #fff; text-decoration: none; border-radius: 6px; display: inline-block;">
         Ver catálogo PDF
      </a>
    </div>
  </div>
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbx-j-3-DVLpiolb8hnzayvxUyDsNoGYmnr1vd1zQ2Sh3VS8fTBjEojFWd0J6tZyY0laog/exec";
const form = document.getElementById("consumiblesForm");
const mensajeExito = document.getElementById("mensajeExito");

form.addEventListener("submit", async e => {
  e.preventDefault();
  document.querySelectorAll('.error').forEach(el => el.style.display = 'none');
  mensajeExito.style.display = 'none';

  const ingeniero = document.getElementById("ingeniero").value.trim();
  const lote = document.getElementById("lote").value.trim();
  const clave = document.getElementById("claveConsumible").value.trim();
  const cantidad = document.getElementById("cantidad").value.trim();

  let valid = true;
  if (!ingeniero) { document.getElementById("errorIngeniero").style.display = "block"; valid = false; }
  if (!lote) { document.getElementById("errorLote").style.display = "block"; valid = false; }
  if (!clave) { document.getElementById("errorClave").style.display = "block"; valid = false; }
  if (!cantidad || cantidad <= 0) { document.getElementById("errorCantidad").style.display = "block"; valid = false; }
  if (!valid) return;

  const formData = new FormData(form);
  try {
    const response = await fetch(scriptURL, { method: "POST", body: formData });
    if (response.ok) {
      form.reset();
      mensajeExito.style.display = 'block';
      setTimeout(() => mensajeExito.style.display = 'none', 4000);
    } else {
      alert("⚠️ Error al guardar la solicitud. Intenta nuevamente.");
    }
  } catch (err) {
    console.error("Error al guardar:", err);
    alert("❌ Hubo un error al enviar la solicitud.");
  }
});
</script>
</body>
</html>